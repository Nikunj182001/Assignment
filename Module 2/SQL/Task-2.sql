USE assignment;

CREATE TABLE SALES_PERSON(
SNO INT PRIMARY KEY,
SNAME TEXT NOT NULL,
CITY TEXT NOT NULL,
COMM FLOAT);

INSERT INTO SALES_PERSON VALUES
(1001,"PEEL","LONDON",0.12),
(1002,"SERRES","SAN JOSE",0.13),
(1003,"AXELROD","NEW YORK",0.1),
(1004,"MOTIKA","LONDON",0.11),
(1007,"RAFKIN","BARCELONA",0.15);

CREATE TABLE CUSTOMER(
CNM INT PRIMARY KEY,
CNAME TEXT NOT NULL,
CITY TEXT NOT NULL,
RATING INT,
SNO INT references SALES_PERSON(SNO));

INSERT INTO CUSTOMER VALUES
(201,"HOFFMAN","LONDON",100,1001),
(202,"GIOVANNE","ROME",200,1003),
(203,"LIU","SAN JOSE",300,1002),
(204,"GRASS","BARCELONA",100,1002),
(206,"CLEMENS","LONDON",300,1007),
(207,"PEREIRA","ROME",100,1004);

CREATE TABLE C_ORDER(
ONM INT PRIMARY KEY,
AMT FLOAT NOT NULL,
ODE DATE,
CNM INT REFERENCES CUSTOMER(CNM),
SNO INT REFERENCES SALES_PERSON(SNO));

INSERT INTO C_ORDER VALUES
(3001,18.69,19941003,201,1007),
(3002,1900.1,19941003,207,1004),
(3003,767.19,19941003,201,1001),
(3005,3005,19941003,203,1002),
(3006,3006,19941004,201,1007),
(3007,3007,19941005,204,1002),
(3008,3008,19941005,206,1001),
(3009,3009,19941004,202,1003),
(3010,3010,19941006,204,1002),
(3011,3011,19941006,206,1001);

-- A)
select * from C_ORDER
where AMT > 1000;

-- B)
select SNAME,CITY FROM SALES_PERSON
WHERE CITY="LONDON" AND COMM > 0.10;

-- C)
select * from SALES_PERSON
WHERE CITY IN("BARCELONA","LONDON");

-- D)
select * from SALES_PERSON
WHERE COMM > 0.10 AND COMM < 0.12;

-- E)
select * from CUSTOMER
WHERE CITY IS NULL;

-- F)
select * from C_ORDER
WHERE ODE IN(19941003,19941004);

-- G)
select C.CNAME,S.SNAME FROM CUSTOMER AS C,SALES_PERSON AS S 
WHERE C.SNO = S.SNO AND (S.SNAME="MOTIKA" OR S.SNAME="PEEL");

-- H)
SELECT * FROM CUSTOMER
WHERE CNAME LIKE('A%','B%');

-- I)
SELECT * FROM CUSTOMER
WHERE RATING > 100 OR CITY = "ROME";

-- J)
SELECT * FROM C_ORDER 
WHERE AMT IS NOT NULL AND NOT 0;

-- K)
SELECT * FROM C_ORDER AS A,SALES_PERSON AS B
WHERE A.SNO = B.SNO;
